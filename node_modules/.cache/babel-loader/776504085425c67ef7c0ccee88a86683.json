{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/yassi/OneDrive/Bureau/Websites/wew/PaintersBlog/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/yassi/OneDrive/Bureau/Websites/wew/PaintersBlog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{auth,provider,storage}from'../firebase';import db from'../firebase';import{SET_USER,SET_LOADING_STATUS,GET_ARTICLES}from'./actionType';export var setUser=function setUser(payload){return{type:SET_USER,user:payload};};export var setLoading=function setLoading(status){return{type:SET_LOADING_STATUS,status:status};};export var getArticles=function getArticles(payload){return{type:GET_ARTICLES,payload:payload};};export function signInAPI(){return function(dispatch){auth.signInWithPopup(provider).then(function(payload){dispatch(setUser(payload.user));}).catch(function(error){return alert(error.message);});};}export function getUserAuth(){return function(dispatch){auth.onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(user){dispatch(setUser(user));}case 1:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};}export function signOutAPI(){return function(dispatch){auth.signOut().then(function(){dispatch(setUser(null));}).catch(function(error){console.log(error.message);});};}export function postArticleAPI(payload){return function(dispatch){dispatch(setLoading(true));if(payload.image!=''){var upload=storage.ref(\"images/\".concat(payload.image.name)).put(payload.image);upload.on('state-changed',function(snapshot){var progress=snapshot.bytesTransferred/snapshot.totalBytes*100;console.log(\"Progress: \".concat(progress,\"%\"));if(snapshot.state==='RUNNING'){console.log(\"Progress: \".concat(progress,\"%\"));}},function(error){return console.log(error.code);},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var downloadURL;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return upload.snapshot.ref.getDownloadURL();case 2:downloadURL=_context2.sent;db.collection(\"articles\").add({actor:{description:payload.user.email,title:payload.user.displayName,date:payload.timestamp,image:payload.user.photoURL},video:payload.video,sharedImg:downloadURL,comments:0,description:payload.description});dispatch(setLoading(false));case 5:case\"end\":return _context2.stop();}},_callee2);})));}else if(payload.video){db.collection('articles').add({actor:{description:payload.user.email,title:payload.user.displayName,date:payload.timestamp,image:payload.user.photoURL},video:payload.video,sharedImg:'',comments:0,description:payload.description});dispatch(setLoading(false));}};}export function getArticlesAPI(){return function(dispatch){var payload;db.collection('articles').orderBy(\"actor.date\",\"desc\").onSnapshot(function(snapshot){payload=snapshot.docs.map(function(doc){return doc.data();});dispatch(getArticles(payload));});};}","map":{"version":3,"names":["auth","provider","storage","db","SET_USER","SET_LOADING_STATUS","GET_ARTICLES","setUser","payload","type","user","setLoading","status","getArticles","signInAPI","dispatch","signInWithPopup","then","catch","error","alert","message","getUserAuth","onAuthStateChanged","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","stop","_x","apply","arguments","signOutAPI","signOut","console","log","postArticleAPI","image","upload","ref","concat","name","put","on","snapshot","progress","bytesTransferred","totalBytes","state","code","_callee2","downloadURL","_callee2$","_context2","getDownloadURL","sent","collection","add","actor","description","email","title","displayName","date","timestamp","photoURL","video","sharedImg","comments","getArticlesAPI","orderBy","onSnapshot","docs","map","doc","data"],"sources":["C:/Users/yassi/OneDrive/Bureau/Websites/wew/paintersblog/src/actions/index.js"],"sourcesContent":["import { auth, provider, storage } from '../firebase';\r\nimport db from '../firebase';\r\nimport { SET_USER, SET_LOADING_STATUS, GET_ARTICLES } from './actionType';\r\n\r\nexport const setUser = (payload) => ({\r\n    type: SET_USER,\r\n    user: payload,\r\n}) \r\n\r\nexport const setLoading = (status) => ({\r\n    type: SET_LOADING_STATUS,\r\n    status : status,\r\n})\r\n\r\nexport const getArticles = (payload) => ({\r\n    type: GET_ARTICLES,\r\n    payload: payload,\r\n})\r\n\r\nexport function signInAPI() {\r\n    return (dispatch) => {\r\n        auth\r\n        .signInWithPopup(provider)\r\n        .then((payload) => {\r\n            dispatch(setUser(payload.user));\r\n        })\r\n        .catch((error) => alert(error.message));\r\n    };\r\n}\r\n\r\nexport function getUserAuth() {\r\n    return (dispatch) => {\r\n        auth.onAuthStateChanged(async (user) => {\r\n            if(user) {\r\n                dispatch(setUser(user));\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nexport function signOutAPI() {\r\n    return(dispatch) => {\r\n        auth\r\n        .signOut()\r\n        .then(() => {\r\n            dispatch(setUser(null));\r\n        })\r\n        .catch((error) => {\r\n            console.log(error.message);\r\n        });\r\n    };\r\n}\r\n\r\nexport function postArticleAPI(payload) {\r\n    return (dispatch) => {\r\n        dispatch(setLoading(true));\r\n\r\n        if(payload.image != '') {\r\n            const upload = storage\r\n                .ref(`images/${payload.image.name}`)\r\n                .put(payload.image);\r\n            upload.on('state-changed', (snapshot) => {\r\n                const progress = \r\n                    (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n\r\n            console.log(`Progress: ${progress}%`);\r\n            if(snapshot.state === 'RUNNING') {\r\n                console.log(`Progress: ${progress}%`);\r\n            }\r\n        }, error => console.log(error.code),\r\n        async () => {\r\n            const downloadURL = await upload.snapshot.ref.getDownloadURL();\r\n            db.collection(\"articles\").add({\r\n                actor: {\r\n                    description: payload.user.email,\r\n                    title: payload.user.displayName,\r\n                    date: payload.timestamp,\r\n                    image: payload.user.photoURL\r\n                },\r\n                video: payload.video,\r\n                sharedImg: downloadURL,\r\n                comments: 0,\r\n                description: payload.description,\r\n            });\r\n            dispatch(setLoading(false));\r\n        });\r\n    }\r\n    else if(payload.video) {\r\n        db.collection('articles').add({\r\n            actor: {\r\n                description: payload.user.email,\r\n                title: payload.user.displayName,\r\n                date: payload.timestamp,\r\n                image: payload.user.photoURL,\r\n            },\r\n            video: payload.video,\r\n            sharedImg: '',\r\n            comments: 0,\r\n            description: payload.description,\r\n        });\r\n        dispatch(setLoading(false));\r\n    }\r\n};\r\n}\r\n\r\nexport function getArticlesAPI() {\r\n    return (dispatch) => {\r\n        let payload;\r\n\r\n        db.collection('articles')\r\n            .orderBy(\"actor.date\", \"desc\")\r\n            .onSnapshot((snapshot) => {\r\n                payload = snapshot.docs.map((doc) => doc.data());\r\n                dispatch(getArticles(payload));\r\n        });\r\n    };\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}